<!doctype html>
<html xmlns="http://www.w3.org/1999/html">
<head>
  <title>eBRS&nbsp;<%=application_mode.upcase%></title>
  <%= stylesheet_link_tag 'application', media: 'all', 'styles' => true %>
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <%= csrf_meta_tags %>

  <style>

  .record td {
    font-size: 18px;
    font-style: italic;
    color: #000;
  }

  .record td strong {
    font-size: 14px;
    font-style: normal;
    color: #3465a4;
  }

  fieldset {
    margin: 20px;
    border-radius: 5px;
    border: 1px solid #3465a4;
    padding: 20px;
  }

  legend {
    font-size: 18px;
    font-weight: normal;
    color: #3465a4;
  }

  .blank {
    font-size:20px;
    color: #9F6000;
    background-color: #FEEFB3;
  }
  #status{
    background: green;
    width: 80%;
    height: 3%;
    margin-top: 0.5%;
    text-align: center;
    font-size: 120%;
    padding: 0.4em;
    color: #FFFFFF;
    border-radius: 50%;
    margin-left: 1.5%;
  }
</style>
  </head>
  <body>

  <% @record.each do |group, person| %>

      <% r = 0 %>

      <fieldset>
        <legend>
          <%= group %>
        </legend>

        <table class="record" width="100%" cellpadding="10" cellspacing="0">

          <% person.each do |child| %>

              <% kids = child.keys %>

              <tr>

                <% (0..(kids.length - 1)).each do |i| %>

                    <td align="left" style="border-left: 1px solid #3465a4;
                      <%= (r < person.length - 1 ? "border-bottom: 1px dotted #3465a4" : "") %>">
                      <% unless kids[i].kind_of?(Array) %>
                          <span style="text-wrap: normal;width: '400px'"><strong><%= kids[i].html_safe %></strong></span>
                      <% else %>
                          <strong><%= kids[i].first.html_safe %><span style='color: red;'> *</span></strong>
                      <% end %>
                    </td>

                    <td style="<%= (r < person.length - 1 ? "border-bottom: 1px dotted #3465a4" : "") %>" id='<%=  kids[i].kind_of?(Array) ? "#{group.gsub(" ", "_").downcase}_#{kids[i].first.gsub(" ", "_").downcase}" : "#{group.gsub(" ", "_").downcase}_#{kids[i].gsub(" ", "_").downcase}"  %>'>
                      : <%= child[kids[i]].html_safe rescue nil %>
                    </td>

                <% end %>

                <% ((kids.length)..2).each do |i| %>

                    <td align="right" style="border-right: 1px dotted #3465a4; <%= (r < person.length - 1 ? "border-bottom: 1px dotted #3465a4" : "") %>">
                      <strong>&nbsp;</strong>
                    </td>
                    <td style="<%= (r < person.length - 1 ? "border-bottom: 1px dotted #3465a4" : "") %>">
                      &nbsp;
                    </td>

                <% end %>

              </tr>

              <% r += 1 %>

          <% end %>

        </table>

      </fieldset>

  <% end %>
  <fieldset>

  </fieldset>

  <!-- % if @person_status == "DC-ACTIVE" # &&  (User.current_user.activities_by_level("DC").include?("Check completeness") || User.current_user.activities_by_level("DC").include?("Approve a child record"))  %>

      <!-- button id="btnViewComment"
              class="blue"
              style="position: absolute; right: 720px; bottom: 20px;"
              onclick="viewComment()">View Comment</button>

  <!-- % end  %>
  <!-- % if @person_status == "DC-ACTIVE" #&&
      #User.current_user.activities_by_level("DC").include?("Check completeness") &&
      #@child.request_status.to_s.strip.upcase == "ACTIVE"  && @child.approved == 'No'  %>
      <!-- % #if @readonly == true % -->
  <!-- button id="btnApprove"
          class="orange"
          style="position: absolute; right: 180px; bottom: 20px;">Check Completeness</button -->
  <!-- % #else % -->
  <!-- button id="btnApprove"
          class="blue"
          style="position: absolute; right: 180px; bottom: 20px;"
          onclick="checkCompleteness()">Check Completeness</button>
<!-- % #end  % -->

  <!-- % end  %>

  <!-- % if @person_status == "DC-ACTIVE" #&&
      #User.current_user.activities_by_level("DC").include?("Check completeness") &&
      #(@child.request_status.to_s.strip.upcase == "IN-COMPLETE" || @child.request_status.to_s.strip.upcase == "PENDING" ) &&
      #@child.approved == 'No'  %>
      <!-- % if @readonly == true % -->
  <!-- button id="btnApprove"
          class="orange"
          style="position: absolute; right: 180px; bottom: 20px;" >Check Completeness</button -->
  <!-- % else % -->
  <!-- button id="btnApprove"
          class="blue"
          style="position: absolute; right: 180px; bottom: 20px;"
          onclick="checkCompleteness()">Check Completeness</button -->
  <!-- % end  % -->

  <!-- % end  % >

  <!-- % if @child.record_status.to_s.strip.upcase == "DC OPEN" &&
      User.current_user.activities_by_level("DC").include?("Check completeness") &&
      (@child.request_status.to_s.strip.upcase == "ACTIVE" ||
          @child.request_status.to_s.strip.upcase != "IN-COMPLETE") &&
      @child.request_status.to_s.strip.upcase != "PENDING" &&
      @child.approved == 'No'  %>

      <!-- % if @readonly == true %>
          <button id="btnQuery"
                  class="orange"
                  style="position: absolute; right: 500px; bottom: 20px;"
          >Mark Pending</button>

      <!-- % else %>

          <button id="btnQuery"
                  class="blue"
                  style="position: absolute; right: 500px; bottom: 20px;"
                  onclick="markPending()">Mark Pending</button>

      <!-- % end %>


  <!-- % end  %>

  <!-- % if (@child.record_status.to_s.strip.upcase == "DC OPEN" &&
      User.current_user.activities_by_level("DC").include?("Approve a child record") &&
      (@child.request_status.to_s.strip.upcase == "COMPLETE" ||
          @child.request_status.to_s.strip.upcase == 'REJECTED' ||
          @child.request_status.to_s.strip.upcase == "GRANTED") &&
      @child.approved == 'No' && record_complete?(@child) == true)  %>



      <!-- % if @readonly == true %>
          <button id="btnApprove"
                  class="orange"
                  style="position: absolute; right: 160px; bottom: 20px;"
                  onclick="">Approve</button>

          <button id="btnReject"
                  class="orange"
                  style="position: absolute; right: 306px; bottom: 20px;"
                  onclick="">Reject</button>

      <!-- % else %>
          <!-- % if @valid_ben %>
              <button id="btnApprove"
                      class="green"
                      style="position: absolute; right: 160px; bottom: 20px;"
                      onclick="approve();">Approve</button>

              <button id="btnReject"
                      class="blue"
                      style="position: absolute; right: 306px; bottom: 20px;"
                      onclick="reject()">Reject</button>

          <!-- % else %>

              <button id="btnApprove"
                      class="red"
                      style="position: absolute; right: 160px; bottom: 20px;"
                      onclick=" ">Approve</button>

              <button id="btnReject"
                      class="red"
                      style="position: absolute; right: 306px; bottom: 20px;"
                      onclick="">Reject</button>

          <!--% end %>
      <!-- % end %>

    <!-- % elsif (@child.record_status.to_s.strip.upcase == "DC OPEN" &&
        User.current_user.activities_by_level("DC").include?("Approve a child record") &&
        (@child.request_status.to_s.strip.upcase == 'PENDING') &&
        @child.approved == 'No' && record_complete?(@child) == true)  %>

        <!-- % if @readonly == true %>
            <button id="btnApprove"
                    class="orange"
                    style="position: absolute; right: 160px; bottom: 20px;"
                    onclick="">Approve</button>

        <!-- % else %>
            <button id="btnApprove"
                    class="green"
                    style="position: absolute; right: 160px; bottom: 20px;"
                    onclick="approve();">Approve</button>
        <!-- % end %>

    <!-- % elsif @child.record_status.to_s.strip.upcase == "DC OPEN" &&
        User.current_user.activities_by_level("DC").include?("Check completeness") &&
        (@child.request_status.to_s.strip.upcase == "COMPLETE" || @child.request_status.to_s.strip.upcase == "REJECTED") &&
        @child.approved == 'No' && record_complete?(@child) == false  %>

        <!-- % if @readonly == true %>
            <button id="btnApprove"
                    class="orange"
                    style="position: absolute; right: 160px; bottom: 20px;"
                    onclick="">Check Completeness</button>

            <button id="btnQuery"
                    class="orange"
                    style="position: absolute; right: 525px; bottom: 20px;"
                    onclick="">Mark Pending</button>

        <!-- % else %>
            <button id="btnApprove"
                    class="blue"
                    style="position: absolute; right: 160px; bottom: 20px;"
                    onclick="checkChild();">Check Completeness</button -->

  <!-- button id="btnQuery"
          class="blue"
          style="position: absolute; right: 525px; bottom: 20px;"
          onclick="markPending()">Mark Pending</button -->

  <!-- % end % -->

  <!-- % elsif @child.record_status.to_s.strip.upcase == "PRINTED"% -->
  <!-- % if @readonly == true % -->
  <!-- button id="btnReopen"
          class="orange"
          style="position: absolute; right: 160px; bottom: 20px;"
          onclick="">Request Amendment</button -->

  <!-- % else % -->
  <!-- button id="btnReopen"
          class="green"
          style="position: absolute; right: 160px; bottom: 20px;"
          onclick="showMessages();">Request Amendment</button -->

  <!-- % end % -->


  <!-- % elsif (User.current_user.activities_by_level("DC").include?("Approve a child record")) % -->

  <!-- button id="btnAction" class="gray" style="position: absolute; right: 160px; bottom: 20px;" onclick="">Approve</button -->

  <!-- % end % -->



  </body>

